{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Simplifying and Contextualizing Sensitivity to Unmeasured Confounding Tipping Point Analyses\"\nsubtitle: \"Advisor: Robert Greevy, Jr.\"\nauthor: \"Lucy D'Agostino McGowan\"\ndate: \"January 27, 2017\"\noutput:\n  xaringan::moon_reader:\n    seal: yes\n    nature:\n      highlightStyle: github\nbibliography: tutorial-manuscript.bib\n---\n\n```{r setup, include=FALSE}\noptions(htmltools.dir.version = FALSE)\nlibrary(\"ggplot2\")\n```\nbackground-image: url(slides_files/thankyou.png)\n\n# Thank you!\n\n## Committee\n\n- Robert Greevy, Jr.\n- Cindy Chen\n- Frank Harrell\n- Peter Rebeiro\n\n## Behind the scenes\n- Ashlee Bartley\n- Amanda Harding\n- My classmates\n- Patrick McGowan\n\n---\n\n# Motivation\n\n- a review of **90 observational studies** with statistically significant findings published in 2015 in\n\n  - JAMA\n  - NEJM\n  - AJE\n\n--\n\n- 41 (45.6%) **mentioned the issue** of unmeasured confounding as a limitation  \n\n--\n\n- 4 (4.4%) **included a quantitative sensitivity analysis**\n\n---\nclass: middle\n\n![](slides_files/overthinking.png)\n\n*On the other hand, it took us embarrassingly long to clue in to the lung cancer/cigarette thing, so I guess the real lesson is \"figuring out which ideas are true is hard.\"*\n---\nclass: middle\n\n## \"In a study with binary outcomes and binary exposures the relative risk may be off by a factor of 2, but unlikely to be off more than that.\" \n*van Belle, G. (2011). Statistical Rules of Thumb. Wiley.*\n\n---\n# History\n\n![](slides_files/timeline/timeline.001.png)\n\n---\n# History\n![](slides_files/timeline/timeline.002.png)\n---\n\nclass: middle\n\n### \"If cigarette smokers have 9 times the risk of nonsmokers for developing lung cancer, and this is not because cigarette smoke is a causal agent, but only because cigarette smokers produce hormone X, then the proportion of hormone-X-producers among cigarette smokers must be at least 9 times greater than that of nonsmokers...\"\n*Cornfield et al. (1959)*\n\n---\nclass: center, middle\n#${\\frac{R_1}{R_0}}$ $=\\frac{p_1r_1+(1-p_1)r_0}{p_0r_1+(1-p_0)r_0}$\n\n---\nclass: center, middle\n#$\\bbox[yellow]{\\frac{R_1}{R_0}}$ $=\\frac{p_1r_1+(1-p_1)r_0}{p_0r_1+(1-p_0)r_0}$\n*relative risk due to the exposure, $R_E$*\n---\nclass: center, middle\n#${R_E}$ $=\\frac{\\bbox[yellow]{p_1}{r_1}+(1-\\bbox[yellow]{p_1}){r_0}}{p_0{r_1}+(1-p_0){r_0}}$\n*proportion exposed that have the unmeasured confounder present*\n---\nclass: center, middle\n#${R_E}$ $=\\frac{{p_1}{r_1}+(1-{p_1}){r_0}}{\\bbox[yellow]{p_0}{r_1}+(1-\\bbox[yellow]{p_0}){r_0}}$\n*proportion unexposed that have the unmeasured confounder present*\n---\nclass: center, middle\n#${R_E}$ $=\\frac{p_1\\bbox[yellow]{r_1}+(1-p_1)r_0}{p_0\\bbox[yellow]{r_1}+(1-p_0)r_0}$\n*outcome rate for those with the unmeasured confounder present*\n---\nclass: center, middle\n#${R_E}$ $=\\frac{p_1{r_1}+(1-p_1)\\bbox[yellow]{r_0}}{p_0{r_1}+(1-p_0)\\bbox[yellow]{r_0}}$\n*outcome rate for those without the unmeasured confounder present*\n---\n\n\n# History\n![](slides_files/timeline/timeline.003.png)\n---\n# Bross\n\n- **\"Size Rule\"**\n\n--\n\n- described the **effect of a single unmeasured confounder** on a given effect \n\n--\n\n- estimated what the relative risk of the exposure effect would be if there was **really no exposure effect**\n---\nclass: center, middle\n\n#$S^*=\\frac{\\Big(\\frac{1-p_{1}}{p_{1}}+\\Gamma\\Big)\\Big(\\frac{1-p_{0}}{p_{0}}+1\\Big)}{\\Big(\\frac{1-p_{0}}{p_{0}}+\\Gamma\\Big)\\Big(\\frac{1-p_{1}}{p_{1}}+1\\Big)}$\n---\nclass: center, middle\n\n#$S^*=\\frac{\\Big(\\frac{1-p_{1}}{p_{1}}+\\bbox[yellow]{\\Gamma}\\Big)\\Big(\\frac{1-p_{0}}{p_{0}}+1\\Big)}{\\Big(\\frac{1-p_{0}}{p_{0}}+\\bbox[yellow]{\\Gamma}\\Big)\\Big(\\frac{1-p_{1}}{p_{1}}+1\\Big)}$\n*$\\Gamma$ is $r_1/r_0$*\n---\nclass: middle\n\n##\"The Size Rule makes it plain that the counterhypothesis is incompatible with the facts concerning cigarette-cancer risks. Hence at this stage there are two choices: Cease to assert the counterhypothesis and continue to be a scientist, or continue to assert the counterhypothesis and cease to be a scientist. In either case there is no longer a scientific controversy.\"\n*Bross, I. D. J. (1966). Spurious effects from an extraneous variable. Journal of Chronic Diseases, 19(6), 637–647*\n---\n# History\n![](slides_files/timeline/timeline.004.png)\n---\nclass: middle, center\n# $R_E=R_{E, new}\\frac{\\Gamma_1p_1+(1-p_1)}{\\Gamma_0p_0+(1-p_0)}$\n---\nclass: middle\n\n<center>\n#$R_E=\\bbox[yellow]{R_{E, new}}\\frac{\\bbox[yellow]{\\Gamma_1}p_1+(1-p_1)}{\\bbox[yellow]{\\Gamma_0}p_0+(1-p_0)}$\n</center>\n- **note:** the same as Cornfield when $R_{E, new}=1$\n  - the exposure does not effect the outcome \n\n--\n\n- and $\\Gamma_1=\\Gamma_0=\\Gamma=r_1/r_0$\n  - when the relative risk due to the unmeasured confounder in the presence of the exposure is equal to the relative risk due to the unmeasured confounder in the absence of the exposure; in other words, there is no interaction.\n---\nclass: center, middle\n# $S^*=\\frac{\\Gamma_1p_1+(1-p_1)}{\\Gamma_0p_0+(1-p_0)}$\n---\nclass: center, middle\n# $S^*=\\frac{\\bbox[yellow]{\\Gamma_1}p_1+(1-p_1)}{\\bbox[yellow]{\\Gamma_0}p_0+(1-p_0)}$\n---\n# History\n![](slides_files/timeline/timeline.005.png)\n---\n# Rosenbaum & Rubin\n\n- allow for categorical covariate adjustment \n\n  - suggest a propensity score analysis, and then stratify based on the propensity score \n\n--\n\n- specify three quantities (sensitivity parameters) \n  1. the proportion of an unmeasured confounder, U, in the population\n  2. the effect of the unmeasured confounder on the treatment assignment (exposure)\n  3.  the effect of the unmeasured confounder on the outcome.   \n\n\n-  estimate treatment effects within different \"subclasses\" and compare under a range of values of the sensitivity parameters specified. \n\n---\n\n# History\n![](slides_files/timeline/timeline.006.png)\n\n---\n# Lin, Psaty, and Kronmal \n\n- add in the assumption that the effects of the unmeasured and measured confounders can be **estimated using a regression framework**\n\n- demonstrate that in the case of a **binary outcome** and a **censored time-to-event outcome** the \"true\" odds ratio or hazard ratio of an exposure can be estimated\n\n---\nclass: center, middle\n# $R_{E, new}=R_E\\frac{\\Gamma_0p_0+(1-p_0)}{\\Gamma_1p_1+(1-p_1)}$\n---\nclass: middle\n\n<center>\n#$R_{E,new}=R_E\\frac{\\Gamma_0p_0+(1-p_0)}{\\Gamma_1p_1+(1-p_1)}$\n</center>\n- same as Schesselman\n\n--\n\n- same as Bross when $\\Gamma_0=\\Gamma_1=\\Gamma$ \n\n--\n\n- same as Cornfield et al. when $\\Gamma_0=\\Gamma_1=\\Gamma$  and $R_{E, new}=1$\n---\n# Lin, Pstay, and Kronmal\n\n- algebraically derive in log-linear regression\n\n  - assuming the unmeasured confounder is independent of covariates conditional on the exposure\n\n--\n\n- provide simulations that show  these sensitivity analyses can be extended to the **logistic regression** and **censored survival time** cases\n\n--\n\n  - assuming the event is rare or if $|\\gamma|$ is small, this approximation holds for logistic regression\n\n--\n\n  - assuming the event is rare or the effect of U on T is small, which implies that $\\Lambda_0(t)$ or $|\\gamma|$ is small, this approximation holds for survial analysis\n\n---\n# Simulations\n### Logistic regression\n- **1000 simulation** samples, each consisting of **1000 subjects**\n\n--\n\n- **$p_0 = 0.2$** & **$p_1 = 0.9$**\n\n- **$\\Gamma = (2,3,4)$**\n--\n\n-  Monte Carlo estimates were:  \n\n    - approximately (1.01, 1.02, 1.03) when the overall event rate was **10%**\n    \n    - approximately (1.02, 1.05, 1.08) when the overall event rate was **50%**\n    \n---\n# Simulations\n### Logistic regression\n\n- **$p_0 = 0.4$** & **$p_1 = 0.6$**\n\n- **$\\Gamma = (2,3,4)$**\n\n--\n\n-  Monte Carlo estimates were: \n\n    -  approximately (1.00, 0.98, 0.96) when the overall event rate was **10%**\n    \n    - approximately (0.98, 0.96, 0.94) when the overall event rate was **50%**. \n---\n# Simulations\n### Survival analysis\n\n- **1000 simulation** samples, each consisting of **1000 subjects**\n\n--\n\n- $p_0 = 0.2$ & $p_1 = 0.9$\n\n- $\\Gamma = (2,3,4)$\n\n--\n\n-  Monte Carlo estimates were: \n\n    -  approximately (1.01, 1.01, 1.02) when the censoring rate was **90%**\n    \n    - approximately (1.00, 0.98, 0.97) when the censoring rate was **50%**. \n---\n\n# History\n![](slides_files/timeline/timeline.007.png)\n---\n# Tipping point analysis\n\n- interested in which values of an unmeasured confounder would cause the lower or upper confidence interval of the association measure to cross 1\n\n--\n\n- assuming the senstivity parameters are fixed, we can extend these methods to confidence bounds\n\n--\n\n- assuming a positive association, indicating that the tipping point analysis will be completed on the lower bound, we have\n\n$$LB_{new}=LB\\frac{\\Gamma p_0+(1-p_0)}{\\Gamma p_1+(1-p_1)}$$\n---\nclass: center, middle\n\n# $\\Gamma(LB, p_0, p_1) = \\frac{(1-p_1)+LB(p_0-1)}{LBp_0-p_1}$\n---\nclass: middle\n## \"in order for our association to no longer be significant, there would need to exist an unmeasured confounder of size $\\Gamma$ that is prevalent in $p_1$ of the exposed population and $p_0$ of the unexposed population.\"\n---\n# Tipping point analysis\n\n- This equation will be of most interest as a sensitivity analysis when\n\n  - $p_1>p_0$ for $LB>1$, yielding a $\\Gamma>1$ needed to tip the analysis\n  - $p_0<p_1$ for $LB<1$ again yielding a $\\Gamma>1$ needed to tip the analysis\n---\n\n```{r, echo = FALSE}\nlb<-seq(1.0,4,.01)\np0.all = seq(0,.9,.1)\nmy_plots <- function(j){\n  p0 = p0.all[j]\n  p1 = seq(p0+.1,1,.1)\n  gamma = sapply(p1, function(p1) (1-p1+lb*(p0-1))/(lb*p0-p1))\n  gamma = ifelse(gamma<lb, NA, gamma)\n  lb = rep(lb, ncol(gamma))\n  p1 = rep(p1,each = 301)\n  gamma = matrix(gamma, ncol = 1)\n  dd <- data.frame(lb, gamma, p1)\n   p <- ggplot(dd) + \n      lims(y = c( 1, 4)) + \n      geom_line(aes(x = lb, y = gamma, group = p1), lwd = 3, color = \"lightblue\") +\n      ggtitle(paste(\"P0 is\",p0, \"varying P1 from\",p0+.1,\"to 1\"))\n   plotly::ggplotly(p)\n}\n```\n\n```{r, echo = FALSE}\nmy_plots(1)\n```\n---\n```{r, echo = FALSE}\nmy_plots(3)\n```\n---\n```{r, echo = FALSE}\nmy_plots(6)\n```\n---\n```{r, echo = FALSE}\nmy_plots(10)\n```\n---\n\n# Write-up\n\nThese methods can easily be incorporated in any study using the following formula:\n\n1. State the primary analysis result\n2. State the size and prevalence of a hypothetical \"tipping point\" confounder\n3. Anchor this in an example from your study\n---\n\n# Example\n\n- retrospective cohort using national Veterans Health Administration (VHA) databases \n\n--\n\n- comparing heart failure and cardiovascular death outcomes among patients initiating two diabetes drugs, metformin or sulfonylurea.\n\n--\n\n- each patient initiated on metformin was propensity score-matched to a patient initiated on sulfonylurea\n---\n# State the primary analysis results\n\nThe primary analysis yielded a greater risk of hospitalization for heart failure or cardiovascular death with sulfonylurea use over metformin use; HR (95% CI): 1.40 (1.30, 1.50). \n\n---\n# State a size and prevalence of a hypothetical “tipping point” confounder:\n\nA hypothetical unobserved binary confounder with a 10% prevalence difference ($p_0=0$, $p_1=0.1$) between the therapies would need to have an association with hospitalization for heart failure or cardiovascular death of HR=4.0 to tip this analysis to nonsignificance at a 5% level. \n\n---\n# State a size and prevalence of a hypothetical “tipping point” confounder:\n\n```{r, echo = FALSE}\nmy_plots(1)\n```\n---\n# Anchor this in an example from your study:\n\nFor a comparison from the observed confounders, baseline congestive heart failure history had a prevalence difference of 5% in the pre-matching cohort and an association with CHF of \nHR=2.30; which would have been insufficient to tip this analysis had we not adjusted for it.\n---\n\n# Conclusion\n\n- we have presented a useful, easily implemented, and  intuitively understood approach to allow researchers to assess the potential impact of unmeasured  confounders in observational research\n\n- our universal figures can be applied to both past and future research, allowing readers to understand the sensitivity of studies that do not include such an analysis, and allowing future investigators to readily include such an analysis. \n---\n\nclass: center, middle\n\n# Thank you!\n\nSlides created via the R package [**xaringan**](https://github.com/yihui/xaringan).\nAnalyses were completed using the following R packages: `ggplot2`, `plotly`\n\n---\n#References\n1. Axelson, O, and K Steenland. 1988. “Indirect methods of assessing the effects of tobacco use in occupational studies.” American Journal of Industrial Medicine.\n2. Belle, G. van. 2011. Statistical Rules of Thumb. Wiley Series in Probability and Statistics. Wiley. https://books.google.com/books?id=UaEL-HI6v2YC.\n3. Bross, IDJ. 1966. “Spurious effects from an extraneous variable.” Journal of Chronic Diseases.\n4. Cornfield, J, W Haenszel, E C Hammond, A M Lilienfeld, M B Shimkin, and E L Wynder. 1959. “Smoking and lung cancer: recent evidence and a discussion of some questions.” Journal of the National Cancer Institute 22 (1): 173–203.\n5. Elrn, E von. 2004. “The scandal of poor epidemiological research.” Bmj.\n6. Fisher, Ronald A. 1958. “Lung Cancer and Cigarettes?” Nature 182 (4628): 108–8.\n7. Gail, M H, S Wacholder, and J H Lubin. 1988. “Indirect corrections for confounding under multiplicative and additive risk models.” American Journal of Industrial Medicine.\n8. Greenland, S. 1996. “Basic methods for sensitivity analysis of biases.” International Journal of Epidemiology.\n---\n#References\n9. Humphrey, L L, BKS Chan, and H C Sox. 2002. “Postmenopausal hormone replacement therapy and the primary prevention of cardiovascular disease.” Annals of Internal Medicine.\n10. Lin, D Y, B M Psaty, and R A Kronmal. 1998. “Assessing the sensitivity of regression results to unmeasured confounders in observational studies.” Biometrics 54 (3): 948–63.\n11. Rosenbaum, P R, and D B Rubin. 1983. “Assessing sensitivity to an unobserved binary covariate in an observational study with binary outcome.” Journal of the Royal Statistical Society Series B ….\n12. Schlesselman, J J. 1978. “Assessing effects of confounding variables.” American Journal of Epidemiology 108 (1): 3–8.\n13. Schneeweiss, S. 2006. “Sensitivity analysis and external adjustment for unmeasured confounders in epidemiologic database studies of therapeutics.” Pharmacoepidemiology and Drug Safety.\n14. Simon, R. 1980. RE:Assessing Effects of Confounding Variables. American Journal of Epidemiology.\n15. Snow, G, and M G Snow. n.d. “Package ’obsSens’.”\n---\n#References\n16. Sourander, L, T Rajala, I Räihä, J Mäkinen, and R Erkkola. 1998. “Cardiovascular and cancer morbidity and mortality and sudden cardiac death in postmenopausal women on oestrogen replacement therapy (ERT).” The Lancet.\n17. Yanagawa, T. 1984. “Case-control studies: assessing the effect of a confounding factor.” Biometrika.\n---\n# log-linear algebra from Lin et al\n\n- what we fit:\n\n$P(Y=1|X,\\mathbf{Z}) = \\exp(\\alpha^{*}+\\beta^{*}X+\\boldsymbol\\theta^{*'}\\mathbf{Z})$\n\n--\n\n- what we wish we fit:\n\n$P(Y = 1|X, \\mathbf{Z})=\\exp(\\alpha+\\beta X+\\boldsymbol{\\theta}'\\mathbf{Z})\\{\\exp(\\gamma X)P_{X,\\mathbf{Z}}+(1-P_{X,\\mathbf{Z}})\\}$\n\n--\n\n- assume that $U$ is independent of $\\mathbf{Z}$ conditional on $X$, therefore $P_{X,\\mathbf{Z}}=P_{X}$\n\n--\n\n$P(Y = 1|X,\\mathbf{Z})=$\n$\\hspace{1cm}\\exp\\Big[\\alpha +\\log\\{e^{\\gamma_0}p_0+(1-p_0)\\}+\\Big\\{\\beta+\\log\\frac{e^{\\gamma_1}p_1+(1-p_1)}{e^{\\gamma_0}p_0+(1-p_0)}\\Big\\}X+\\boldsymbol\\theta'\\mathbf{Z}\\Big]$\n\n--\n* setting what we fit = what we wish we fit\n\n$\\beta = \\beta^*-\\log\\frac{e^{\\gamma_1}p_1+(1-p_1)}{e^{\\gamma_0}p_0+(1-p_0)}$",
    "created" : 1488489422766.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2560394935",
    "id" : "C2FE71FA",
    "lastKnownWriteTime" : 1486419096,
    "last_content_update" : 1486419096,
    "path" : "~/Documents/wonderland/oral-exam/slides.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}